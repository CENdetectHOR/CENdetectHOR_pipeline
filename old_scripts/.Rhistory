dec="~/recas/CENdetectHOR/results/decomposition/HSA/1/final_decomposition_raw.tsv"
dec_file="~/recas/CENdetectHOR/results/decomposition/HSA/1/final_decomposition_raw.tsv"
bed_file="~/recas/CENdetectHOR/results/wind2analize/HSA.FULLchr.windows.filtered.bed"
dec=read.table(dec_file)
dec <- dec %>% mutate(end=V4+1) %>% select(V1,V2,V3,end)
colnames(dec) <- c("seq","match","rel_start","rel_end")
suppressMessages(library(dplyr))
suppressMessages(library(data.table))
suppressMessages(library(GenomicRanges))
dec <- dec %>% mutate(end=V4+1) %>% select(V1,V2,V3,end)
colnames(dec) <- c("seq","match","rel_start","rel_end")
dec_file="~/recas/CENdetectHOR/results/decomposition/HSA/1/final_decomposition_raw.tsv"
bed_file="~/recas/CENdetectHOR/results/wind2analize/HSA.FULLchr.windows.filtered.bed"
dec=read.table(dec_file)
dec <- dec %>% mutate(end=V4+1) %>% select(V1,V2,V3,end)
colnames(dec) <- c("seq","match","rel_start","rel_end")
str2split <- as.character(dec$seq[1])
chr=strsplit(str2split,split = ":")[[1]][1]
pos=strsplit(str2split,split = ":")[[1]][2]
start_piece=as.numeric(strsplit(pos,split = "-")[[1]][1])
end_piece=as.numeric(strsplit(pos,split = "-")[[1]][2])
dec <- dec %>% mutate(chr4head=chr) %>%   mutate(start4head=rel_start+start_piece) %>%
mutate(end4head=rel_end+start_piece) %>% mutate(name= paste0(chr4head,":",start4head, "-", end4head))
StringDec <- makeGRangesFromDataFrame(dec, start.field = "start4head", end.field = "end4head", seqnames.field = "seq",
ignore.strand = T, keep.extra.columns = T)
bed=read.table(bed_file)
bed <- bed %>% mutate(V1=(unique(dec$seq)))
bed <- makeGRangesFromDataFrame(bed, start.field = "V2", end.field = "V3", seqnames.field = "V1",keep.extra.columns = T)
StringDec_filtered <- subsetByOverlaps(StringDec, bed, type = "within")
StringDec_filtered <-  as.data.frame(StringDec_filtered)
StringDec_filtered <- StringDec_filtered %>% mutate(s= case_when(endsWith(match, "'") ~ "-", .default = "+"))
StringDec_filtered <- StringDec_filtered %>% mutate(score=".") %>% select(seqnames,rel_start,rel_end,name, score, s)
dec_file <- "~/recas/CENdetectHOR/results/decomposition/HSA/X/final_decomposition_raw.tsv"
suppressMessages(library(dplyr))
suppressMessages(library(data.table))
suppressMessages(library(GenomicRanges))
dec_file <- "~/recas/CENdetectHOR/results/decomposition/HSA/X/final_decomposition_raw.tsv"
dec=read.table(dec_file)
dec <- dec %>% mutate(end=V4+1) %>% select(V1,V2,V3,end)
colnames(dec) <- c("seq","match","rel_start","rel_end")
str2split <- as.character(dec$seq[1])
chr=strsplit(str2split,split = ":")[[1]][1]
pos=strsplit(str2split,split = ":")[[1]][2]
start_piece=as.numeric(strsplit(pos,split = "-")[[1]][1])
end_piece=as.numeric(strsplit(pos,split = "-")[[1]][2])
dec <- dec %>% mutate(chr4head=chr) %>%   mutate(start4head=rel_start+start_piece) %>%
mutate(end4head=rel_end+start_piece) %>% mutate(name= paste0(chr4head,":",start4head, "-", end4head))
StringDec <- makeGRangesFromDataFrame(dec, start.field = "start4head", end.field = "end4head", seqnames.field = "seq",
ignore.strand = T, keep.extra.columns = T)
bed_file <- "~/recas/CENdetectHOR/results/wind2analize/HSA.FULLchr.windows.filtered.bed"
bed=read.table(bed_file)
bed <- bed %>% mutate(V1=(unique(dec$seq)))
bed <- makeGRangesFromDataFrame(bed, start.field = "V2", end.field = "V3", seqnames.field = "V1",keep.extra.columns = T)
StringDec_filtered <- subsetByOverlaps(StringDec, bed, type = "within")
dec_file <- "~/recas/CENdetectHOR/splittedCHR/partial_results_presT2T/chrX_dec/final_decomposition_raw.tsv"
dec=read.table(dec_file)
dec <- dec %>% mutate(end=V4+1) %>% select(V1,V2,V3,end)
colnames(dec) <- c("seq","match","rel_start","rel_end")
str2split <- as.character(dec$seq[1])
chr=strsplit(str2split,split = ":")[[1]][1]
pos=strsplit(str2split,split = ":")[[1]][2]
start_piece=as.numeric(strsplit(pos,split = "-")[[1]][1])
end_piece=as.numeric(strsplit(pos,split = "-")[[1]][2])
dec <- dec %>% mutate(chr4head=chr) %>%   mutate(start4head=rel_start+start_piece) %>%
mutate(end4head=rel_end+start_piece) %>% mutate(name= paste0(chr4head,":",start4head, "-", end4head))
View(bed)
StringDec_filtered <-  as.data.frame(StringDec_filtered)
View(StringDec_filtered)
View(bed)
View(dec)
bed_file <- "~/recas/CENdetectHOR/results/wind2analize/HSA.FULLchr.windows.filtered.bed"
bed=read.table(bed_file)
bed <- bed %>% mutate(V1=(unique(dec$seq)))
View(bed)
View(bed)
bed_file <- "~/recas/CENdetectHOR/results/wind2analize/HSA.FULLchr.windows.filtered.bed"
bed=read.table(bed_file)
View(bed)
View(bed)
View(bed)
View(dec)
View(bed)
bed %>% filter(V1=chr) %>% mutate(V1=(unique(dec$seq)))
bed %>% filter(V1==chr) %>% mutate(V1=(unique(dec$seq)))
bed <- bed %>% filter(V1==chr) %>% mutate(V1=(unique(dec$seq)))
bed <- makeGRangesFromDataFrame(bed, start.field = "V2", end.field = "V3", seqnames.field = "V1",keep.extra.columns = T)
StringDec_filtered <- subsetByOverlaps(StringDec, bed, type = "within")
dec_file <- "~/recas/CENdetectHOR/splittedCHR/partial_results_presT2T/chrX_dec/final_decomposition_raw.tsv"
dec=read.table(dec_file)
dec <- dec %>% mutate(end=V4+1) %>% select(V1,V2,V3,end)
colnames(dec) <- c("seq","match","rel_start","rel_end")
str2split <- as.character(dec$seq[1])
chr=strsplit(str2split,split = ":")[[1]][1]
pos=strsplit(str2split,split = ":")[[1]][2]
start_piece=as.numeric(strsplit(pos,split = "-")[[1]][1])
end_piece=as.numeric(strsplit(pos,split = "-")[[1]][2])
dec <- dec %>% mutate(chr4head=chr) %>%   mutate(start4head=rel_start+start_piece) %>%
mutate(end4head=rel_end+start_piece) %>% mutate(name= paste0(chr4head,":",start4head, "-", end4head))
StringDec <- makeGRangesFromDataFrame(dec, start.field = "start4head", end.field = "end4head", seqnames.field = "seq",
ignore.strand = T, keep.extra.columns = T)
bed_file <- "~/recas/CENdetectHOR/results/wind2analize/HSA.FULLchr.windows.filtered.bed"
bed=read.table(bed_file)
bed <- bed %>% filter(V1==chr) %>% mutate(V1=(unique(dec$seq)))
bed <- makeGRangesFromDataFrame(bed, start.field = "V2", end.field = "V3", seqnames.field = "V1",keep.extra.columns = T)
StringDec_filtered <- subsetByOverlaps(StringDec, bed, type = "within")
StringDec_filtered <-  as.data.frame(StringDec_filtered)
StringDec_filtered <- StringDec_filtered %>% mutate(s= case_when(endsWith(match, "'") ~ "-", .default = "+"))
StringDec_filtered <- StringDec_filtered %>% mutate(score=".") %>% select(seqnames,rel_start,rel_end,name, score, s)
